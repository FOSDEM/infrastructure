---

prometheus_snmp_default_targets:
  - router001.fosdem.net
  - 192.168.211.250
  - 192.168.211.254
  - 192.168.211.252
  - 192.168.211.251
  - 192.168.211.240
  - 192.168.211.253


rsyslog_repeated_msg_reduction: true
rsyslog_rsyslog_d_files:
  20-log-routers:
    settings:
      - 'module(load="imudp")'
      - 'input(type="imudp" port="514")'
      - '$template DynFile,"/var/log/router-log/%FROMHOST%"'
      - ':source , !isequal , "server-hostname" ?DynFile'
      - ':source , !isequal , "server-hostname" stop'

caddy_features: prometheus
caddy_config: |
  {{ ansible_nodename }}
  gzip
  tls network@lists.fosdem.org 
  root /var/www
  prometheus
  log /var/log/caddy/access.log
  proxy /prometheus localhost:9090
  proxy / localhost:3000 {
    transparent
  }

grafana_conf_data: |
  app_mode = development

  [paths]
  data = {{ grafana_dir_data }}
  logs = {{ grafana_dir_log }}
  plugins = {{ grafana_dir_plugins }}

  [server]
  protocol = http
  http_port = {{ grafana_http_port }}
  domain = {{ ansible_nodename }}

  [database]
  type = {{ grafana_database.type }}
  host = {{ grafana_database.host }}
  name = {{ grafana_database.name }}
  user = {{ grafana_database.user }}
  password = {{ grafana_database.password }}
  path = {{ grafana_database.path }}

  [session]

  [analytics]
  check_for_updates = true

  [security]
  admin_user = {{ grafana_admin_user }}
  admin_password = {{ grafana_admin_password }}

  [snapshots]

  [users]

  [auth.anonymous]

  [auth.github]

  [auth.google]

  [auth.proxy]

  [auth.basic]

  [auth.ldap]

  [smtp]

  [emails]

  [log]
  mode = file
  level = Info

  [log.console]

  [log.file]

  [event_publisher]

  [dashboards.json]
