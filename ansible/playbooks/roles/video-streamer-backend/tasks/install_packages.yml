---
- name: "create preferences file for nginx"
  copy: src=apt/preferences dest=/etc/apt/preferences.d/fosdem-video owner=root group=root mode=0644

- name: "add stretch-backports for libnginx-mod-rtmp"
  apt_repository: repo='deb http://httpredir.debian.org/debian/ stretch-backports main' state=present update_cache=yes

- name: "install packages"
  apt: pkg={{ item }} state=latest install_recommends=no
  with_items:
    - ffmpeg
    - libglib-object-introspection-perl
    - gir1.2-gstreamer-1.0
    - gir1.2-gst-plugins-base-1.0
    - gstreamer1.0-plugins-base
    - gstreamer1.0-plugins-good
    - gstreamer1.0-plugins-bad
    - gstreamer1.0-plugins-ugly
    - gstreamer1.0-libav
    - libdbd-pg-perl

- name: "install nginx from stretch-backports"
  apt: pkg={{ item }} state=latest install_recommends=no default_release=stretch-backports update_cache=yes
  with_items:
    - libnginx-mod-rtmp
    - nginx-common
    - nginx-doc
    - nginx-extras
