---
- name: run setup
  setup:

- name: fix the hosts file so gridengine will work
  template:
    dest: /etc/hosts
    src: hosts.j2
    owner: root
    group: root
    mode: 0664
  register: hosts_fix

- name: install load script
  copy:
    src: load.sh
    dest: /usr/local/bin/load.sh
    mode: 0755

- name: restart gridengine service when needed
  service:
    name: gridengine-exec
    enabled: yes
    state: started
  when: hosts_fix.changed
