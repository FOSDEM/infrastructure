- name: Install ruby packages
  apt: name={{item}} state=latest update_cache=true cache_valid_time=600
  with_items:
    - ruby
    - ruby-dev
    - cmake
    - libsqlite3-dev
    - libssl-dev
    - pkg-config

- name: Add oxidized user
  user:
    name: oxidized
    group: oxidized
    home: /opt/oxidized
    createhome: yes
    shell: /bin/bash
    comment: "oxidized user"
    system: yes

- name: Install oxidized
  gem: name={{item}} state=latest user_install=no
  with_items:
    - oxidized
    - oxidized-script
    - oxidized-web
